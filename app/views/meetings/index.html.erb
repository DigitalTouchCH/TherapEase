<div class="container-with-sidebar">
  <%= render 'shared/sidebar' %>

  <div class="content-column">

    <!--
    <div class="shadow-rounded mb-5">
      <h3 class="text-center">My Services</h3>
      <div class="d-grid gap-2 col-2 mx-auto">
        <h5 class="btn btn-primary mb-3 texte-center"> Add a new service</h5>
      </div>
      <br>
      <div class="cards mb-3">
        <% @therapist.services.each do |service| %>
          <div class="card-category text-center" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(<%= cl_image_path(service.photo.key) %>)">
            <h4><%= service.name %></h4>
            <p>Price : <%= service.price_per_unit %> | Duration : <%= service.duration_per_unit %> min.</p>
          </div>
        <% end %>
      </div>
    </div>
    -->

    <div class="shadow-rounded mb-5">
      <h3 class="text-center">My meetings</h3>
      <%= week_calendar attribute: :start_time, events: @events_with_dates do |date, events| %>
        <div class="day-events" style="height: 620px;">
          <% events.each do |event| %>
            <% if event.is_a?(Meeting) %>
              <div class="meeting-card"
                  style="top: <%= calculate_top_position(event) %>%;
                          height: <%= calculate_height_for_meeting(event) %>%;
                          background-color: <%= event.package.service.color %>;">
                <%= event.start_time.strftime('%H:%M') %> - <%= (event.start_time + event.package.service.duration_per_unit.minutes).strftime('%H:%M') %> - <%= link_to event.package.patient.first_name[0] + ". " + event.package.patient.last_name, patient_path(event.package.patient) %>
              </div>
            <% elsif event.is_a?(Absence) %>
              <div class="absence-card"
                  style="top: <%= calculate_top_position(event) %>%;
                  height: <%= calculate_height_for_meeting(event) %>%;">
                <strong><%= event.start_time.strftime('%H:%M') %> à <%= event.end_time.strftime('%H:%M') %></strong>
                <br>
                Absence (<%= event.reason %>)
                <br>
                <%= link_to edit_absence_path(event) do %>
                  <i class="fas fas-black fa-edit" title="Edit"></i>
                <% end %>
              </div>
            <% end %>
          <% end %>
        </div>
      <% end %>
    </div>



    <!-- WITHOUT PROPORTIONALITIES -->
    <!--
    <div class="shadow-rounded mb-5">
      <h3 class="text-center">My meetings</h3>
        <%= week_calendar attribute: :start_time, events: @events_with_dates do |date, events| %>
          <div class="day-events">
            <% events.each do |event| %>
              <% if event.is_a?(Meeting) %>
                <div class="absence-card" style="top: <%= (event.start_time.hour * 60) + event.start_time.min %>px; background-color: <%= event.package.service.color %>;">
                  <strong><%= event.start_time.strftime('%H:%M') %> to <%= (event.start_time + event.package.service.duration_per_unit.minutes).strftime('%H:%M') %></strong>
                  <br>
                  <%= event.package.service.name %>
                  <br>
                  <strong><%= event.package.patient.first_name + " " + event.package.patient.last_name %></strong>
                </div>
              <% elsif event.is_a?(Absence) %>
                <div class="absence-card" style="top: <%= (event.start_time.hour * 60) + event.start_time.min %>px;">
                  <strong><%= event.start_time.strftime('%H:%M') %> à <%= event.end_time.strftime('%H:%M') %></strong>
                  <br>
                  Absence (<%= event.reason %>)
                  <br>
                  <%= link_to edit_absence_path(event) do %>
                    <i class="fas fas-black fa-edit" title="Edit"></i>
                  <% end %>
                </div>
              <% end %>
            <% end %>
          </div>
        <% end %>
    </div>
    -->

  </div>

</div>


<!-- WITHOUT ABCENSES -->
<!--
    <%= week_calendar attribute: :start_time, events: @meetings_with_dates do |date, meetings| %>
      <div class="day-meetings">
        <% meetings.each do |meeting| %>
          <div class="meeting-card" style="top: <%= (meeting.start_time.hour * 60) + meeting.start_time.min %>px;">
            <%= meeting.start_time.strftime('%H:%M') %> - <%= (meeting.start_time + meeting.package.service.duration_per_unit.minutes).strftime('%H:%M') %>
            <br>
            <%= meeting.package.service.name %>
            <br>
            <% meeting.bookings.each do |booking| %>
              <%= booking.patient.first_name + " " + booking.patient.last_name %>
            <% end %>
          </div>
        <% end %>
      </div>
    <% end %>
-->


<!-- UGLY STYLE -->
<!--
  <%= week_calendar attribute: :start_time, events: @meetings_with_dates do |date, meetings| %>
    <%= date.strftime('%A, %B %d') %>

    <div class="day-meetings">
      <% meetings.each do |meeting| %>
        <div class="meeting-card" style="top: <%= (meeting.start_time.hour * 60) + meeting.start_time.min %>px;">
          <%= meeting.start_time.strftime('%H:%M') %> - <%= (meeting.start_time + meeting.package.service.duration_per_unit.minutes).strftime('%H:%M') %>
          <br>
          <%= meeting.package.service.name %>
          <br>
          <% meeting.bookings.each do |booking| %>
            <%= booking.patient.first_name + " " + booking.patient.last_name %>
          <% end %>
        </div>
      <% end %>
    </div>
  <% end %>
-->
